<div class="missions-container">
    <div class="missions-header">
        <h1>Missions</h1>
        <button mat-raised-button color="primary" (click)="openCreateMissionDialog()">
            <mat-icon>add</mat-icon>
            Create Mission
        </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
        <mat-spinner></mat-spinner>
        <p>Loading missions...</p>
    </div>

    <!-- Missions Content -->
    <div *ngIf="!isLoading" class="missions-content">
        <mat-card>
            <mat-card-content>
                <!-- Empty State -->
                <div *ngIf="missions.length === 0" class="no-data">
                    <mat-icon>assignment</mat-icon>
                    <p>No missions found. Create your first mission to get started.</p>
                </div>

                <!-- Missions Table -->
                <table *ngIf="missions.length > 0" mat-table [dataSource]="paginatedMissions" class="missions-table">
                    <!-- Name Column -->
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef>Mission Name</th>
                        <td mat-cell *matCellDef="let mission">{{ mission.name }}</td>
                    </ng-container>

                    <!-- Start Time Column -->
                    <ng-container matColumnDef="startTime">
                        <th mat-header-cell *matHeaderCellDef>Start Time</th>
                        <td mat-cell *matCellDef="let mission">
                            {{ mission.startTime | date:'short' }}
                        </td>
                    </ng-container>

                    <!-- End Time Column -->
                    <ng-container matColumnDef="endTime">
                        <th mat-header-cell *matHeaderCellDef>End Time</th>
                        <td mat-cell *matCellDef="let mission">
                            {{ mission.endTime | date:'short' }}
                        </td>
                    </ng-container>

                    <!-- Vehicle Count Column -->
                    <ng-container matColumnDef="vehicleCount">
                        <th mat-header-cell *matHeaderCellDef>Vehicles</th>
                        <td mat-cell *matCellDef="let mission">{{ getVehicleCount(mission) }}</td>
                    </ng-container>

                    <!-- Status Column -->
                    <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef>Status</th>
                        <td mat-cell *matCellDef="let mission">
                            <span [class]="getMissionStatusClass(mission.status)">
                                {{ mission.status }}
                            </span>
                        </td>
                    </ng-container>

                    <!-- Actions Column -->
                    <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef>Actions</th>
                        <td mat-cell *matCellDef="let mission">
                            <div class="mission-actions">
                                <button mat-icon-button (click)="openEditMissionDialog(mission)"
                                    matTooltip="Edit Mission">
                                    <mat-icon>edit</mat-icon>
                                </button>
                                <button mat-icon-button (click)="deleteMission(mission)" matTooltip="Delete Mission"
                                    color="warn">
                                    <mat-icon>delete</mat-icon>
                                </button>
                                <mat-form-field appearance="outline" class="status-select">
                                    <mat-label>Status</mat-label>
                                    <mat-select [value]="mission.status"
                                        (selectionChange)="updateMissionStatus(mission, $event.value)">
                                        <mat-option *ngFor="let option of getStatusOptions()" [value]="option.value">
                                            {{ option.label }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>

                <!-- Pagination -->
                <div *ngIf="missions.length > 0" class="pagination-container">
                    <div class="pagination-info">
                        Showing {{ getStartItem() }} to {{ getEndItem() }} of {{ totalItems }} missions
                    </div>

                    <div class="pagination-controls">
                        <button mat-icon-button [disabled]="currentPage === 1" (click)="onPageChange(1)"
                            matTooltip="First page">
                            <mat-icon>first_page</mat-icon>
                        </button>

                        <button mat-icon-button [disabled]="currentPage === 1" (click)="onPageChange(currentPage - 1)"
                            matTooltip="Previous page">
                            <mat-icon>chevron_left</mat-icon>
                        </button>

                        <button *ngFor="let page of getPageNumbers()" mat-button [class.active]="page === currentPage"
                            (click)="onPageChange(page)" class="page-button">
                            {{ page }}
                        </button>

                        <button mat-icon-button [disabled]="currentPage === totalPages"
                            (click)="onPageChange(currentPage + 1)" matTooltip="Next page">
                            <mat-icon>chevron_right</mat-icon>
                        </button>

                        <button mat-icon-button [disabled]="currentPage === totalPages"
                            (click)="onPageChange(totalPages)" matTooltip="Last page">
                            <mat-icon>last_page</mat-icon>
                        </button>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
</div>